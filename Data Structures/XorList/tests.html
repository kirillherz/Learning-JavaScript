<!DOCTYPE html>
<html>

    <head>
        <meta charset="utf-8">

        <!-- подключаем стили Mocha, для отображения результатов -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mocha/2.1.0/mocha.css">
        <!-- подключаем библиотеку Mocha -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mocha/2.1.0/mocha.js"></script>
        <!-- настраиваем Mocha: предстоит BDD-тестирование -->
        <script>
            mocha.setup('bdd');
        </script>

        <!-- подключаем chai -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/chai/2.0.0/chai.js"></script>
        <!-- в chai есть много всего, выносим assert в глобальную область -->
        <script>
            var assert = chai.assert;
        </script>
        <script src="XorList.js"></script>
    </head>

    <body>

        <script>

            describe("push", function () {

                it("Считает размер списка", function () {
                    var l = new XorList();
                    l.push(0);
                    l.push(1);
                    l.push(2);
                    l.push(3);
                    l.push(2);
                    assert.equal(l.getSize(), 5);
                });
                it("Правильно считает адреса", function () {
                    var l = new XorList();
                    l.push(0);
                    l.push(1);
                    l.push(2);
                    l.push(3);
                    l.push(4);
                    var iterator = l.getAdressIterator();
                    assert.equal(iterator.next().value, -2);
                    assert.equal(iterator.next().value, 2);
                    assert.equal(iterator.next().value, 2);
                    assert.equal(iterator.next().value, 6);
                    assert.equal(iterator.next().value, -4);
                });
                it("Правильно сохраняет элементы", function () {
                    var l = new XorList();
                    l.push(0);
                    l.push(1);
                    l.push(2);
                    l.push(3);
                    l.push(4);
                    var iterator = l[Symbol.iterator]();
                    assert.equal(iterator.next().value, 0);
                    assert.equal(iterator.next().value, 1);
                    assert.equal(iterator.next().value, 2);
                    assert.equal(iterator.next().value, 3);
                    assert.equal(iterator.next().value, 4);
                });

            });

            describe("pop", function () {
                it("Считает размер списка", function () {
                    var l = new XorList();
                    l.push(0);
                    l.push(1);
                    l.push(2);
                    l.push(3);
                    l.push(4);
                    l.pop();
                    assert.equal(l.getSize(), 4);
                    l.pop();
                    assert.equal(l.getSize(), 3);
                    l.pop();
                    assert.equal(l.getSize(), 2);
                    l.pop();
                    assert.equal(l.getSize(), 1);
                    l.pop();
                    assert.equal(l.getSize(), 0);


                });
                it("Правильно считает адреса", function () {
                    var l = new XorList();
                    l.push(0);
                    l.push(1);
                    l.push(2);
                    l.push(3);
                    l.push(4);
                    l.pop();
                    var iterator = l.getAdressIterator();
                    assert.equal(iterator.next().value, -2);
                    assert.equal(iterator.next().value, 2);
                    assert.equal(iterator.next().value, 2);
                    assert.equal(iterator.next().value, -3);
                    l.pop();
                    iterator = l.getAdressIterator();
                    assert.equal(iterator.next().value, -2);
                    assert.equal(iterator.next().value, 2);
                    assert.equal(iterator.next().value, -2);
                    l.pop();
                    iterator = l.getAdressIterator();
                    assert.equal(iterator.next().value, -2);
                    assert.equal(iterator.next().value, -1);
                    l.pop();
                    iterator = l.getAdressIterator();
                    assert.equal(iterator.next().value, 0);
                });
                it("Правильно удаляет элементы", function () {
                    var l = new XorList();
                    l.push(0);
                    l.push(1);
                    l.push(2);
                    l.push(3);
                    l.push(4);
                    l.pop();
                    var iterator = l[Symbol.iterator]();
                    assert.equal(iterator.next().value, 0);
                    assert.equal(iterator.next().value, 1);
                    assert.equal(iterator.next().value, 2);
                    assert.equal(iterator.next().value, 3);
                    l.pop();
                    iterator = l[Symbol.iterator]();
                    assert.equal(iterator.next().value, 0);
                    assert.equal(iterator.next().value, 1);
                    assert.equal(iterator.next().value, 2);
                    l.pop();
                    iterator = l[Symbol.iterator]();
                    assert.equal(iterator.next().value, 0);
                    assert.equal(iterator.next().value, 1);
                    l.pop();
                    iterator = l[Symbol.iterator]();
                    assert.equal(iterator.next().value, 0);
                });
            });
            describe("unshift", function () {

                it("Считает размер списка", function () {
                    var l = new XorList();
                    l.unshift(2);
                    l.unshift(1);
                    l.unshift(0);
                    assert.equal(l.getSize(), 3);

                });

            });
            describe("insert", function () {

                it("Считает размер списка", function () {
                    var l = new XorList();
                    l.insert(0, 0);
                    l.insert(1, 1);
                    l.insert(2, 2);
                    assert.equal(l.getSize(), 3);

                });

            });
        </script>
        <!-- в элементе с id="mocha" будут результаты тестов -->
        <div id="mocha"></div>

        <!-- запустить тесты! -->
        <script>
            mocha.run();
        </script>
    </body>

</html>